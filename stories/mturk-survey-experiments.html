<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="description" content="A guide for running survey experiments on MTurk, like I did in my thesis">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MTurk Survey Experiments | Ask Dav</title>

    
            <link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/code.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/theme.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

      <link rel="canonical" href="http://askdav.com/stories/mturk-survey-experiments.html">




    
        <!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->

    


    

    <meta name="description" itemprop="description" content="A guide for running survey experiments on MTurk, like I did in my thesis">
    <meta name="author" content="@davclark">
    
    <meta name="og:title" content="MTurk Survey Experiments">
    <meta name="og:url" content="http://askdav.com/stories/mturk-survey-experiments.html">
    <meta name="og:description" content="A guide for running survey experiments on MTurk, like I did in my thesis">
    <meta name="og:site_name" content="Ask Dav">
    <meta name="og:type" content="article">

    

    



</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://askdav.com/">

                <span id="blog-title">Ask Dav</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../archive.html">Archive</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../rss.xml">RSS feed</a>

                
            </li>
</ul>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="mturk-survey-experiments.md" id="sourcelink">Source</a>
    </li>

                
            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav>

<!-- End of Menubar -->

<div class="container" id="content">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            <!-- We put this on top on small screens, but on the right on wide
            screend -->
            <div class="col-md-4 col-md-push-8">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <!-- For some reason, Nikola's theme appears to have
                        messed up the following h2 tag -->
                        <!--h2 class="panel-title"-->Dav's Projects

                    </div>
                    <div class="panel-body">
                        <!-- I want to make this generated from markdown! -->
                        <ul>
                            <li>
<a href="http://dlab-berkeley.github.io/dlab-methods">
                            D-Lab Methods</a>
                            </li>
<li>
<a href="http://statsforchange.org">Stats for
                            Change</a>
                            </li>
<li>
<a href="http://collaboratool.berkeley.edu">BCE
                            - Berkeley's standard environment for research and
                              teaching</a>
                            </li>
<li>
<a href="https://osf.io/iwdru/">MTurk Admin - a
                            library to make longitudinal "crowdsourcing"
                            experiments easier</a>
                        </li>
</ul>
                    </div>

                </div>
            </div>
            <div class="col-md-8 col-md-pull-4">
                
<article class="storypage" itemscope="itemscope" itemtype="http://schema.org/Article">
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">MTurk Survey Experiments</a></h1>

        

    </header>
    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>This is a work in progress for helping my fellow researchers run survey
experiments while avoiding some pitfalls.</p>
<h2>Template for HTML to use for your HIT on Amazon</h2>
<p>I got the kernel for this from another social scientists blog, and I’d like to
attribute it. I just haven’t had time to track it down!</p>
<pre class="code literal-block"><span class="c">&lt;!-- &lt;p id='workerId'&gt;No javascript run&lt;/p&gt; --&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span><span class="o">&lt;!</span><span class="nt">--</span>
<span class="nc">.highlight-box</span> <span class="p">{</span>
  <span class="k">border</span><span class="o">:</span><span class="k">solid</span> <span class="m">0px</span> <span class="m">#98BE10</span><span class="p">;</span>
  <span class="k">background</span><span class="o">:</span><span class="m">#FCF9CE</span><span class="p">;</span>
  <span class="k">color</span><span class="o">:</span><span class="m">#222222</span><span class="p">;</span>
  <span class="k">padding</span><span class="o">:</span><span class="m">4px</span><span class="p">;</span>
  <span class="k">text-align</span><span class="o">:</span><span class="k">left</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="k">smaller</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">#beforeAccept</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">block</span> <span class="p">}</span>
<span class="nf">#workerNotFound</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">none</span><span class="p">}</span>
<span class="nf">#workerFound</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">none</span> <span class="p">}</span>
<span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">]</span> <span class="p">{</span> <span class="k">visibility</span><span class="o">:</span><span class="k">hidden</span> <span class="p">}</span>
<span class="nt">--</span><span class="o">&gt;</span><span class="nt">&lt;/style&gt;</span>

<span class="c">&lt;!-- Google CDN is fast, but to avoid errors, we need to switch to amazon hosted --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"</span>
    <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="c">&lt;!-- This is the recommended approach from crypto-js website --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/sha1.js"</span>
    <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span><span class="c">&lt;!--</span>
<span class="kd">function</span> <span class="nx">getParamFromURL</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This was in the original code, not necessary</span>
    <span class="c1">// name = name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");</span>

    <span class="c1">// MTurk screws up and (at least sometimes) puts &amp; instead of &amp; in the URL!</span>
    <span class="c1">// Regexps are char based, so we need only check for a ; prior to our</span>
    <span class="c1">// name. If we want to test for the whole &amp; token, we need to work</span>
    <span class="c1">// outside of []'s and use |</span>
    <span class="kd">var</span> <span class="nx">regexS</span> <span class="o">=</span> <span class="s2">"[\?&amp;;]"</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">"=([^&amp;#]*)"</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">regex</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">regexS</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="nx">regex</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="nx">results</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">)</span>
        <span class="k">return</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="nx">results</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// This is hashed to protect workers privacy (though the risk here is low)</span>
<span class="c1">// I don't care much about my privacy on the first line, compared to</span>
<span class="c1">// debugging, though!</span>
<span class="c1">// When done right, these should look like '942cf38dce8bcd7310476ae53fe5a906170c7d2d'</span>

<span class="kd">var</span> <span class="nx">hashed_workers</span> <span class="o">=</span> <span class="p">[</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">SHA1</span><span class="p">(</span><span class="s2">"A2DLTP7A10KG4T"</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">),</span>
                     <span class="p">];</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">load</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// We now have an initial state where visibility is set in CSS</span>
    <span class="kd">var</span> <span class="nx">workerId</span> <span class="o">=</span> <span class="nx">getParamFromURL</span><span class="p">(</span><span class="s1">'workerId'</span><span class="p">);</span>

    <span class="c1">// This is for debugging, along with the commented span at the top</span>
    <span class="c1">// $("#workerId").text('Javascript detected worker ID "' + workerId + '"')</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">workerId</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Can't use inArray on full CryptoJS hash objects</span>
        <span class="kd">var</span> <span class="nx">hashedId</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">SHA1</span><span class="p">(</span><span class="nx">workerId</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">);</span>

        <span class="c1">// Is the (hashed) ID in our list of (hashed) IDs?</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">hashedId</span><span class="p">,</span> <span class="nx">hashed_workers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
            <span class="c1">// Worker was found</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">"#beforeAccept"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'display'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">);</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">"#workerFound"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'display'</span><span class="p">,</span><span class="s1">'block'</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Worker was not found</span>
            <span class="kd">var</span> <span class="nx">link_elt</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#surveyLink'</span><span class="p">);</span>

            <span class="nx">link_elt</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="s1">'href'</span><span class="p">,</span> <span class="nx">link_elt</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'&amp;workerId='</span> <span class="o">+</span> <span class="nx">workerId</span><span class="p">);</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">"#workerNotFound"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'display'</span><span class="p">,</span><span class="s1">'block'</span><span class="p">);</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">"#beforeAccept"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'display'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">);</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">"[type='submit']"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'visibility'</span><span class="p">,</span><span class="s1">'visible'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="o">--&gt;</span><span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"beforeAccept"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;h3&gt;</span>Complete a short survey<span class="nt">&lt;/h3&gt;</span>

 <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"highlight-box"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>We are conducting an educational research survey about political
  attitudes and scientific knowledge. You are allowed 60 minutes, but it
  will likely take you less than 30. You<span class="ni">&amp;#39;</span>ll also probably learn
  something!<span class="nt">&lt;/p&gt;</span>

  <span class="nt">&lt;p&gt;</span>If you accept this HIT, some javascript will run to see if you<span class="ni">&amp;#39;</span>re
  elegible. If you<span class="ni">&amp;#39;</span>ve taken another one of our surveys, you are
  ineligible for this one.<span class="nt">&lt;/p&gt;</span>
 <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"workerNotFound"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h3&gt;</span>Complete a short survey<span class="nt">&lt;/h3&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"highlight-box"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>Follow the link below to complete the survey. At the end of the
    survey, you will receive a code to paste into the box below to receive
    credit for taking our survey. Please give the survey your full attention
    (no web or e-mail).<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="c">&lt;!-- We have our base link here in case there's a snafu with updating the link --&gt;</span>

  <span class="nt">&lt;p&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://ucbpsych.qualtrics.com/SE/?SID=SV_0AFVoIpzwIbnDqR"</span> <span class="na">id=</span><span class="s">"surveyLink"</span> <span class="na">target=</span><span class="s">"_blank"</span><span class="nt">&gt;</span>Survey link<span class="nt">&lt;/a&gt;&lt;/p&gt;</span>

  <span class="nt">&lt;p&gt;</span>Provide the survey code here (or leave me a note if there<span class="ni">&amp;#39;</span>s any problem):<span class="nt">&lt;/p&gt;</span>

  <span class="nt">&lt;p&gt;&lt;input</span> <span class="na">id=</span><span class="s">"Code"</span> <span class="na">name=</span><span class="s">"Code"</span> <span class="na">size=</span><span class="s">"10"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"workerFound"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h3&gt;</span>Sorry<span class="nt">&lt;/h3&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"highlight-box"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>You<span class="ni">&amp;#39;</span>ve done work on another one of our surveys. So, thanks for
    your interest, but please release the HIT!<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre>
</div>
    </div>
    

</article>

            </div>
        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:davclark@berkeley.edu">@davclark</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
    </div>
</div>


            <script src="../assets/js/jquery.min.js"></script>
            <script src="../assets/js/bootstrap.min.js"></script>
        <script src="../assets/js/jquery.colorbox-min.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    


</body>
</html>
